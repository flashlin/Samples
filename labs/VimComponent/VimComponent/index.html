<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vim Editor Component</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background-color: #1e1e1e;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        vim-editor {
            border: 1px solid #333;
            background-color: #000;
            display: block;
        }
        canvas {
            display: block;
        }
        .controls {
            margin: 20px 0;
            display: flex;
            gap: 10px;
        }
        button {
            padding: 10px 20px;
            background-color: #007acc;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background-color: #005a9e;
        }
    </style>
</head>
<body>
    <h1>Vim Editor Component Demo</h1>
    <div class="controls">
        <button onclick="loadSampleCode()">Load Sample Code</button>
        <button onclick="loadMarkdown()">Load Markdown</button>
        <button onclick="loadJSON()">Load JSON</button>
    </div>
    <vim-editor width="90%" height="300px"></vim-editor>
    Sample 2
    <vim-editor width="90%" height="300px"></vim-editor>
    <script type="module" src="/src/vim-editor.ts"></script>
    <script type="module">
        const editor = document.querySelector('vim-editor');

        editor.addEventListener('change', (event) => {
            console.log('Content changed:', event.detail.content.join('\n'));
        });

        editor.addEventListener('keypress', (event) => {
            console.log('Key pressed:', {
                key: event.detail.key,
                mode: event.detail.mode,
                ctrl: event.detail.ctrlKey,
                shift: event.detail.shiftKey,
                alt: event.detail.altKey,
                meta: event.detail.metaKey,
                cursor: `${event.detail.cursorX},${event.detail.cursorY}`
            });
        });

        window.loadSampleCode = function() {
            const code = `function fibonacci(n) {
  if (n <= 1) {
    return n;
  }
  return fibonacci(n - 1) + fibonacci(n - 2);
}

console.log(fibonacci(10));`;
            editor.load(code);
        };

        window.loadMarkdown = function() {
            const markdown = `# VimEditor Component

A powerful Vim-like editor built as a Web Component.

## Features

- Normal mode navigation
- Visual mode selection
- Insert mode editing
- Command patterns support
- Bracket matching with %
- And much more!

## Usage

\`\`\`javascript
const editor = document.querySelector('vim-editor');
editor.load('Your text here');
\`\`\``;
            editor.load(markdown);
        };

        window.loadJSON = function() {
            const json = `{
  "name": "vim-editor",
  "version": "1.0.0",
  "description": "A Vim-like editor component",
  "features": [
    "Normal mode",
    "Visual mode",
    "Insert mode",
    "Bracket matching"
  ],
  "author": "Your Name"
}`;
            editor.load(json);
        };
    </script>
</body>
</html>